use crate::types::{packed, prelude::*};

#[test]
fn test_headers_update() {
    // Data from Mainnet:
    // - Client: Block Number: 16079980~16079999 (slot: 5246100~5246119)
    // - Updates: Block Number: 16080000~16080029 (slot: 5246120~5246149)
    let client_slice = &[
        148, 12, 80, 0, 0, 0, 0, 0, 167, 12, 80, 0, 0, 0, 0, 0, 148, 12, 80, 0, 0, 0, 0, 0, 167,
        12, 80, 0, 0, 0, 0, 0, 58, 244, 24, 59, 194, 0, 156, 83, 71, 113, 87, 185, 86, 241, 136,
        204, 25, 230, 8, 137, 33, 93, 128, 116, 160, 150, 88, 70, 221, 11, 246, 34,
    ];
    let headers_update_slice = &[
        20, 7, 0, 0, 28, 0, 0, 0, 68, 0, 0, 0, 216, 0, 0, 0, 140, 5, 0, 0, 128, 6, 0, 0, 176, 6, 0,
        0, 167, 12, 80, 0, 0, 0, 0, 0, 83, 0, 41, 38, 42, 195, 167, 126, 34, 39, 215, 91, 201, 20,
        11, 157, 161, 8, 128, 147, 9, 119, 182, 37, 112, 246, 135, 82, 212, 166, 40, 192, 3, 0, 0,
        0, 148, 12, 80, 0, 0, 0, 0, 0, 163, 12, 80, 0, 0, 0, 0, 0, 49, 8, 232, 207, 236, 136, 109,
        22, 204, 202, 35, 125, 236, 104, 82, 149, 180, 13, 212, 90, 5, 251, 47, 137, 53, 80, 104,
        230, 175, 184, 10, 122, 166, 12, 80, 0, 0, 0, 0, 0, 166, 12, 80, 0, 0, 0, 0, 0, 137, 61,
        89, 3, 19, 184, 223, 109, 141, 7, 179, 218, 199, 137, 108, 151, 242, 20, 225, 249, 68, 49,
        91, 6, 57, 132, 12, 83, 118, 216, 241, 87, 164, 12, 80, 0, 0, 0, 0, 0, 165, 12, 80, 0, 0,
        0, 0, 0, 236, 116, 49, 17, 111, 44, 199, 80, 201, 101, 188, 90, 206, 15, 28, 125, 27, 194,
        23, 145, 92, 134, 87, 21, 20, 7, 137, 165, 75, 23, 9, 30, 30, 0, 0, 0, 168, 12, 80, 0, 0,
        0, 0, 0, 183, 47, 171, 31, 203, 212, 136, 108, 53, 254, 218, 134, 61, 37, 23, 82, 74, 50,
        142, 113, 86, 219, 123, 233, 99, 9, 20, 62, 20, 105, 147, 37, 169, 12, 80, 0, 0, 0, 0, 0,
        139, 61, 21, 175, 169, 155, 145, 112, 217, 198, 102, 43, 155, 212, 199, 9, 119, 254, 149,
        223, 109, 158, 140, 55, 21, 158, 128, 228, 227, 151, 13, 52, 170, 12, 80, 0, 0, 0, 0, 0,
        30, 20, 11, 61, 205, 98, 79, 113, 248, 211, 204, 204, 223, 82, 85, 109, 37, 91, 220, 154,
        214, 151, 249, 77, 131, 57, 204, 150, 179, 161, 68, 94, 171, 12, 80, 0, 0, 0, 0, 0, 252,
        229, 38, 161, 237, 93, 214, 99, 75, 184, 91, 23, 172, 246, 241, 205, 214, 140, 199, 67,
        219, 33, 20, 105, 177, 255, 114, 192, 7, 189, 51, 136, 172, 12, 80, 0, 0, 0, 0, 0, 73, 225,
        251, 133, 103, 240, 7, 145, 133, 173, 231, 110, 151, 179, 156, 21, 222, 54, 66, 232, 227,
        0, 152, 189, 31, 95, 56, 220, 76, 157, 147, 7, 173, 12, 80, 0, 0, 0, 0, 0, 11, 200, 144,
        150, 29, 60, 253, 238, 37, 138, 66, 51, 86, 54, 228, 160, 90, 187, 109, 173, 27, 255, 91,
        170, 47, 29, 27, 175, 233, 192, 241, 185, 174, 12, 80, 0, 0, 0, 0, 0, 250, 191, 84, 194,
        101, 201, 124, 140, 136, 170, 52, 172, 232, 24, 235, 40, 170, 224, 75, 16, 6, 93, 76, 181,
        164, 162, 201, 127, 231, 110, 187, 2, 175, 12, 80, 0, 0, 0, 0, 0, 146, 58, 160, 137, 99,
        52, 6, 88, 232, 227, 217, 185, 186, 132, 157, 93, 26, 158, 39, 126, 29, 38, 14, 105, 228,
        92, 51, 220, 107, 249, 132, 48, 176, 12, 80, 0, 0, 0, 0, 0, 181, 104, 26, 122, 194, 161,
        178, 75, 25, 177, 176, 187, 196, 224, 53, 58, 117, 228, 239, 26, 96, 166, 200, 35, 252, 90,
        106, 68, 9, 71, 12, 9, 177, 12, 80, 0, 0, 0, 0, 0, 188, 2, 79, 68, 31, 171, 54, 16, 190,
        229, 231, 122, 176, 87, 117, 39, 81, 21, 122, 150, 172, 46, 6, 232, 42, 174, 45, 137, 80,
        78, 185, 86, 178, 12, 80, 0, 0, 0, 0, 0, 215, 119, 192, 252, 4, 173, 42, 188, 156, 101, 97,
        50, 195, 168, 72, 150, 123, 171, 130, 223, 250, 105, 25, 179, 200, 14, 23, 191, 111, 7,
        191, 168, 179, 12, 80, 0, 0, 0, 0, 0, 249, 82, 45, 131, 94, 114, 215, 138, 87, 241, 181,
        100, 132, 35, 120, 55, 240, 151, 211, 63, 58, 77, 233, 137, 91, 206, 210, 33, 101, 146,
        142, 65, 180, 12, 80, 0, 0, 0, 0, 0, 193, 208, 179, 164, 62, 214, 150, 229, 87, 95, 82,
        205, 1, 80, 183, 121, 206, 144, 206, 35, 214, 56, 250, 139, 253, 88, 143, 92, 171, 211,
        107, 72, 181, 12, 80, 0, 0, 0, 0, 0, 252, 60, 217, 116, 58, 73, 40, 76, 227, 49, 119, 109,
        182, 63, 28, 75, 164, 221, 95, 67, 210, 192, 106, 46, 159, 190, 103, 7, 79, 44, 213, 202,
        182, 12, 80, 0, 0, 0, 0, 0, 204, 240, 39, 166, 187, 237, 132, 21, 99, 99, 12, 16, 103, 199,
        11, 196, 206, 253, 26, 101, 66, 160, 183, 232, 189, 96, 239, 17, 138, 250, 72, 168, 183,
        12, 80, 0, 0, 0, 0, 0, 227, 92, 235, 172, 81, 249, 25, 222, 40, 151, 41, 56, 18, 58, 30,
        219, 115, 31, 51, 115, 19, 160, 87, 127, 167, 123, 97, 62, 188, 217, 49, 226, 184, 12, 80,
        0, 0, 0, 0, 0, 228, 180, 169, 121, 182, 10, 11, 52, 127, 61, 134, 171, 70, 64, 43, 103,
        222, 80, 32, 185, 11, 70, 113, 70, 41, 101, 175, 107, 145, 233, 162, 20, 185, 12, 80, 0, 0,
        0, 0, 0, 47, 4, 202, 46, 205, 74, 135, 134, 252, 153, 145, 148, 91, 43, 42, 123, 5, 56,
        167, 124, 4, 28, 94, 234, 37, 101, 59, 206, 221, 237, 192, 126, 186, 12, 80, 0, 0, 0, 0, 0,
        219, 21, 102, 30, 116, 170, 146, 105, 113, 205, 76, 18, 143, 175, 224, 199, 210, 180, 180,
        84, 30, 44, 18, 237, 77, 194, 17, 236, 197, 224, 156, 138, 187, 12, 80, 0, 0, 0, 0, 0, 221,
        173, 100, 148, 3, 197, 143, 36, 1, 165, 205, 232, 101, 160, 214, 238, 81, 216, 238, 194,
        169, 148, 63, 135, 247, 188, 161, 121, 233, 252, 80, 109, 188, 12, 80, 0, 0, 0, 0, 0, 138,
        139, 140, 131, 126, 190, 57, 122, 125, 173, 172, 165, 57, 131, 156, 159, 187, 37, 96, 61,
        195, 238, 9, 235, 251, 46, 33, 67, 67, 186, 198, 204, 189, 12, 80, 0, 0, 0, 0, 0, 68, 187,
        38, 237, 219, 34, 135, 158, 91, 41, 160, 87, 68, 41, 6, 168, 74, 158, 197, 28, 244, 29, 90,
        176, 173, 94, 238, 137, 154, 133, 145, 210, 190, 12, 80, 0, 0, 0, 0, 0, 24, 229, 245, 242,
        236, 144, 231, 241, 214, 111, 93, 25, 153, 204, 191, 52, 129, 64, 241, 106, 160, 93, 18,
        196, 228, 228, 123, 85, 159, 221, 191, 29, 191, 12, 80, 0, 0, 0, 0, 0, 19, 205, 167, 166,
        10, 118, 92, 129, 97, 249, 155, 124, 224, 63, 184, 225, 60, 40, 27, 164, 170, 146, 216,
        179, 17, 103, 45, 30, 248, 232, 127, 161, 192, 12, 80, 0, 0, 0, 0, 0, 175, 62, 185, 99, 17,
        61, 188, 116, 211, 102, 167, 193, 78, 195, 204, 182, 187, 53, 32, 100, 198, 202, 234, 55,
        28, 244, 69, 102, 35, 163, 184, 107, 193, 12, 80, 0, 0, 0, 0, 0, 219, 209, 152, 43, 99, 93,
        37, 156, 105, 140, 99, 27, 141, 200, 71, 78, 23, 94, 0, 206, 67, 174, 214, 88, 105, 184,
        35, 121, 219, 64, 127, 154, 194, 12, 80, 0, 0, 0, 0, 0, 154, 143, 20, 24, 183, 85, 187, 31,
        31, 252, 167, 30, 177, 189, 79, 40, 4, 136, 115, 56, 183, 113, 73, 211, 90, 210, 146, 61,
        139, 248, 5, 25, 195, 12, 80, 0, 0, 0, 0, 0, 250, 178, 194, 225, 44, 8, 151, 155, 154, 155,
        233, 40, 109, 219, 155, 74, 68, 14, 56, 3, 27, 248, 155, 83, 108, 90, 137, 210, 170, 139,
        1, 12, 196, 12, 80, 0, 0, 0, 0, 0, 215, 206, 63, 135, 121, 76, 160, 126, 155, 159, 131, 59,
        92, 115, 126, 98, 37, 68, 128, 252, 69, 55, 248, 240, 231, 63, 237, 228, 216, 148, 105,
        241, 197, 12, 80, 0, 0, 0, 0, 0, 209, 69, 149, 10, 81, 193, 240, 120, 86, 150, 164, 8, 89,
        234, 123, 22, 19, 139, 3, 156, 205, 136, 162, 19, 79, 90, 129, 183, 18, 216, 123, 195, 244,
        0, 0, 0, 124, 0, 0, 0, 128, 0, 0, 0, 132, 0, 0, 0, 136, 0, 0, 0, 140, 0, 0, 0, 144, 0, 0,
        0, 148, 0, 0, 0, 152, 0, 0, 0, 156, 0, 0, 0, 160, 0, 0, 0, 164, 0, 0, 0, 168, 0, 0, 0, 172,
        0, 0, 0, 176, 0, 0, 0, 180, 0, 0, 0, 184, 0, 0, 0, 188, 0, 0, 0, 192, 0, 0, 0, 196, 0, 0,
        0, 200, 0, 0, 0, 204, 0, 0, 0, 208, 0, 0, 0, 212, 0, 0, 0, 216, 0, 0, 0, 220, 0, 0, 0, 224,
        0, 0, 0, 228, 0, 0, 0, 232, 0, 0, 0, 236, 0, 0, 0, 240, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 148, 12, 80, 0, 0, 0, 0, 0,
        197, 12, 80, 0, 0, 0, 0, 0, 56, 7, 87, 59, 122, 234, 229, 137, 217, 243, 164, 23, 241, 172,
        140, 148, 182, 106, 176, 241, 163, 125, 39, 30, 48, 69, 153, 78, 235, 36, 142, 240, 2, 0,
        0, 0, 164, 12, 80, 0, 0, 0, 0, 0, 167, 12, 80, 0, 0, 0, 0, 0, 250, 225, 212, 21, 65, 47,
        49, 129, 215, 170, 94, 29, 15, 64, 123, 33, 244, 228, 68, 35, 40, 180, 22, 176, 19, 40, 43,
        21, 251, 198, 42, 211, 148, 12, 80, 0, 0, 0, 0, 0, 163, 12, 80, 0, 0, 0, 0, 0, 49, 8, 232,
        207, 236, 136, 109, 22, 204, 202, 35, 125, 236, 104, 82, 149, 180, 13, 212, 90, 5, 251, 47,
        137, 53, 80, 104, 230, 175, 184, 10, 122,
    ];

    let packed_client = packed::ClientReader::from_slice(client_slice).unwrap();
    let packed_headers_update =
        packed::HeadersUpdateReader::from_slice(headers_update_slice).unwrap();

    let client = packed_client.unpack();
    let result = client.try_apply_packed_updates(packed_headers_update);
    assert!(result.is_ok());
}

#[test]
fn test_transaction_verification() {
    // Data from Mainnet:
    // - Headers: Block Number: 16079980~16080029 (slot: 5246100~5246149)
    // - Transaction: Block Number: 16080000 (slot: 5246120); Index in Block: 87
    let client_slice = &[
        148, 12, 80, 0, 0, 0, 0, 0, 197, 12, 80, 0, 0, 0, 0, 0, 148, 12, 80, 0, 0, 0, 0, 0, 197,
        12, 80, 0, 0, 0, 0, 0, 56, 7, 87, 59, 122, 234, 229, 137, 217, 243, 164, 23, 241, 172, 140,
        148, 182, 106, 176, 241, 163, 125, 39, 30, 48, 69, 153, 78, 235, 36, 142, 240,
    ];
    let proof_slice = &[
        50, 11, 0, 0, 32, 0, 0, 0, 72, 0, 0, 0, 80, 0, 0, 0, 112, 0, 0, 0, 148, 1, 0, 0, 56, 5, 0,
        0, 46, 10, 0, 0, 168, 12, 80, 0, 0, 0, 0, 0, 183, 47, 171, 31, 203, 212, 136, 108, 53, 254,
        218, 134, 61, 37, 23, 82, 74, 50, 142, 113, 86, 219, 123, 233, 99, 9, 20, 62, 20, 105, 147,
        37, 87, 0, 0, 0, 0, 0, 0, 0, 174, 102, 0, 192, 120, 28, 241, 104, 128, 244, 84, 251, 102,
        30, 126, 108, 86, 33, 54, 116, 222, 195, 138, 236, 65, 40, 244, 50, 13, 83, 122, 239, 6, 0,
        0, 0, 169, 12, 80, 0, 0, 0, 0, 0, 169, 12, 80, 0, 0, 0, 0, 0, 139, 61, 21, 175, 169, 155,
        145, 112, 217, 198, 102, 43, 155, 212, 199, 9, 119, 254, 149, 223, 109, 158, 140, 55, 21,
        158, 128, 228, 227, 151, 13, 52, 170, 12, 80, 0, 0, 0, 0, 0, 171, 12, 80, 0, 0, 0, 0, 0,
        203, 40, 73, 179, 46, 199, 113, 150, 114, 210, 119, 248, 92, 209, 15, 62, 150, 19, 183,
        237, 49, 35, 243, 89, 34, 55, 49, 12, 243, 210, 195, 199, 164, 12, 80, 0, 0, 0, 0, 0, 167,
        12, 80, 0, 0, 0, 0, 0, 250, 225, 212, 21, 65, 47, 49, 129, 215, 170, 94, 29, 15, 64, 123,
        33, 244, 228, 68, 35, 40, 180, 22, 176, 19, 40, 43, 21, 251, 198, 42, 211, 172, 12, 80, 0,
        0, 0, 0, 0, 179, 12, 80, 0, 0, 0, 0, 0, 41, 41, 89, 27, 250, 40, 100, 249, 229, 164, 177,
        24, 102, 65, 56, 139, 196, 128, 59, 227, 107, 77, 244, 159, 181, 152, 172, 80, 220, 116,
        154, 117, 148, 12, 80, 0, 0, 0, 0, 0, 163, 12, 80, 0, 0, 0, 0, 0, 49, 8, 232, 207, 236,
        136, 109, 22, 204, 202, 35, 125, 236, 104, 82, 149, 180, 13, 212, 90, 5, 251, 47, 137, 53,
        80, 104, 230, 175, 184, 10, 122, 180, 12, 80, 0, 0, 0, 0, 0, 197, 12, 80, 0, 0, 0, 0, 0,
        167, 66, 28, 192, 51, 167, 168, 142, 157, 182, 83, 20, 158, 237, 212, 240, 96, 150, 93,
        156, 172, 88, 215, 222, 16, 15, 40, 108, 216, 40, 198, 208, 29, 0, 0, 0, 28, 242, 193, 69,
        207, 166, 93, 158, 99, 205, 255, 156, 183, 153, 64, 56, 148, 225, 90, 159, 30, 228, 148,
        132, 3, 102, 87, 232, 127, 115, 179, 245, 12, 57, 101, 97, 62, 178, 195, 177, 51, 241, 86,
        13, 143, 228, 252, 29, 219, 142, 198, 119, 70, 22, 96, 70, 75, 240, 123, 221, 14, 255, 61,
        154, 74, 246, 230, 61, 146, 51, 52, 88, 138, 154, 163, 67, 123, 96, 194, 147, 251, 226, 54,
        114, 233, 95, 237, 48, 89, 253, 89, 127, 248, 46, 13, 149, 155, 92, 182, 235, 72, 178, 3,
        37, 85, 102, 178, 21, 248, 17, 6, 71, 145, 55, 12, 179, 99, 206, 71, 27, 183, 141, 170,
        232, 144, 123, 3, 182, 152, 34, 180, 244, 18, 181, 99, 207, 228, 33, 130, 112, 226, 107,
        170, 239, 226, 191, 55, 197, 24, 182, 218, 159, 108, 224, 225, 21, 240, 239, 250, 38, 78,
        63, 202, 174, 202, 56, 56, 53, 8, 250, 114, 128, 236, 139, 166, 162, 241, 124, 187, 179,
        36, 107, 66, 154, 223, 163, 148, 13, 10, 81, 72, 69, 249, 197, 175, 193, 100, 109, 193,
        189, 226, 182, 107, 145, 184, 186, 198, 14, 116, 45, 168, 56, 107, 158, 208, 4, 105, 17,
        11, 251, 224, 38, 141, 140, 135, 235, 13, 219, 165, 126, 53, 246, 210, 134, 103, 56, 2,
        164, 175, 89, 117, 226, 37, 6, 199, 207, 76, 100, 187, 107, 229, 238, 17, 82, 127, 44, 38,
        132, 100, 118, 253, 95, 197, 74, 93, 67, 56, 81, 103, 201, 81, 68, 242, 100, 63, 83, 60,
        200, 91, 185, 209, 107, 120, 47, 141, 125, 177, 147, 80, 109, 134, 88, 45, 37, 36, 5, 184,
        64, 1, 135, 146, 202, 210, 191, 18, 89, 241, 239, 90, 165, 248, 135, 225, 60, 178, 240, 9,
        79, 81, 225, 255, 255, 10, 215, 230, 89, 119, 47, 149, 52, 193, 149, 200, 21, 239, 196, 1,
        78, 241, 225, 218, 237, 68, 4, 192, 99, 133, 209, 17, 146, 233, 43, 108, 240, 65, 39, 219,
        5, 68, 28, 216, 51, 16, 122, 82, 190, 133, 40, 104, 137, 14, 67, 23, 230, 160, 42, 180,
        118, 131, 170, 117, 150, 66, 32, 183, 208, 95, 135, 95, 20, 0, 39, 239, 81, 24, 162, 36,
        123, 187, 132, 206, 143, 47, 15, 17, 35, 98, 48, 133, 218, 247, 150, 12, 50, 159, 95, 223,
        106, 245, 245, 187, 219, 107, 233, 239, 138, 166, 24, 228, 191, 128, 115, 150, 8, 103, 23,
        30, 41, 103, 111, 139, 40, 77, 234, 106, 8, 168, 94, 181, 141, 144, 15, 94, 24, 46, 60, 80,
        239, 116, 150, 158, 161, 108, 119, 38, 197, 73, 117, 124, 194, 53, 35, 195, 105, 88, 125,
        167, 41, 55, 132, 212, 154, 117, 2, 255, 207, 176, 52, 11, 29, 120, 133, 104, 133, 0, 202,
        48, 129, 97, 167, 249, 107, 98, 223, 157, 8, 59, 113, 252, 200, 242, 187, 143, 230, 177,
        104, 146, 86, 192, 211, 133, 244, 47, 91, 190, 32, 39, 162, 44, 25, 150, 225, 16, 186, 151,
        193, 113, 211, 229, 148, 141, 233, 43, 235, 141, 13, 99, 195, 158, 186, 222, 133, 9, 224,
        174, 60, 156, 56, 118, 251, 95, 161, 18, 190, 24, 249, 5, 236, 172, 254, 203, 146, 5, 118,
        3, 171, 149, 238, 200, 178, 229, 65, 202, 212, 233, 29, 227, 131, 133, 242, 224, 70, 97,
        159, 84, 73, 108, 35, 130, 203, 108, 172, 213, 185, 140, 38, 245, 164, 248, 147, 233, 8,
        145, 119, 117, 182, 43, 255, 35, 41, 77, 187, 227, 161, 205, 142, 108, 193, 195, 91, 72, 1,
        136, 123, 100, 106, 111, 129, 241, 127, 105, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 191, 44, 187, 216, 118, 67, 46, 40, 178,
        115, 105, 192, 74, 57, 93, 5, 33, 237, 27, 127, 41, 61, 235, 123, 233, 3, 132, 116, 199,
        209, 254, 245, 165, 253, 66, 209, 106, 32, 48, 39, 152, 239, 110, 211, 9, 151, 155, 67, 0,
        61, 35, 32, 217, 240, 232, 234, 152, 49, 169, 39, 89, 251, 75, 221, 68, 232, 242, 169, 3,
        247, 158, 70, 157, 249, 1, 123, 39, 128, 51, 72, 246, 114, 108, 249, 196, 240, 207, 208,
        137, 183, 142, 11, 158, 70, 102, 169, 155, 117, 223, 133, 219, 102, 30, 216, 5, 37, 189, 1,
        81, 199, 173, 77, 191, 12, 112, 72, 115, 201, 111, 179, 184, 15, 152, 92, 115, 89, 25, 28,
        123, 165, 191, 6, 126, 187, 143, 21, 80, 220, 80, 150, 21, 84, 178, 178, 226, 124, 92, 7,
        67, 22, 191, 184, 27, 210, 21, 196, 235, 188, 213, 245, 165, 253, 66, 209, 106, 32, 48, 39,
        152, 239, 110, 211, 9, 151, 155, 67, 0, 61, 35, 32, 217, 240, 232, 234, 152, 49, 169, 39,
        89, 251, 75, 219, 86, 17, 78, 0, 253, 212, 193, 248, 92, 137, 43, 243, 90, 201, 168, 146,
        137, 170, 236, 177, 235, 208, 169, 108, 222, 96, 106, 116, 139, 93, 113, 128, 167, 68, 103,
        128, 199, 110, 18, 112, 43, 208, 74, 23, 156, 97, 51, 105, 65, 84, 221, 29, 47, 107, 47,
        231, 52, 22, 76, 252, 19, 64, 192, 246, 4, 0, 0, 16, 0, 0, 0, 40, 1, 0, 0, 64, 3, 0, 0, 20,
        1, 0, 0, 249, 1, 17, 160, 33, 242, 51, 116, 178, 207, 68, 26, 154, 89, 127, 72, 63, 69, 5,
        244, 147, 228, 250, 162, 195, 47, 83, 58, 24, 46, 184, 246, 136, 14, 171, 199, 160, 194,
        238, 250, 237, 62, 114, 255, 240, 78, 181, 246, 246, 106, 225, 34, 211, 13, 9, 214, 158,
        73, 15, 46, 178, 222, 146, 67, 211, 17, 193, 238, 234, 160, 105, 55, 225, 0, 99, 252, 195,
        233, 212, 198, 95, 71, 62, 9, 52, 50, 30, 203, 48, 220, 67, 170, 93, 142, 114, 55, 122,
        251, 168, 16, 122, 118, 160, 120, 203, 5, 219, 135, 207, 73, 155, 118, 31, 213, 254, 146,
        221, 214, 51, 182, 31, 151, 52, 232, 58, 21, 34, 124, 4, 241, 191, 131, 23, 138, 91, 160,
        106, 165, 174, 111, 205, 136, 82, 92, 134, 48, 163, 145, 195, 252, 80, 32, 208, 113, 16,
        192, 169, 194, 8, 135, 195, 45, 232, 133, 120, 147, 144, 122, 160, 19, 102, 40, 24, 26,
        206, 21, 57, 63, 163, 215, 243, 166, 19, 9, 70, 248, 44, 233, 199, 214, 147, 114, 96, 67,
        246, 180, 82, 26, 47, 42, 32, 160, 231, 186, 18, 218, 251, 61, 144, 227, 214, 205, 147, 16,
        198, 180, 153, 253, 251, 119, 244, 57, 237, 45, 204, 56, 4, 149, 121, 15, 228, 131, 109,
        63, 128, 160, 214, 179, 3, 212, 190, 126, 130, 42, 44, 209, 4, 111, 212, 237, 105, 128,
        182, 25, 50, 64, 210, 50, 15, 150, 118, 158, 161, 192, 41, 165, 84, 47, 128, 128, 128, 128,
        128, 128, 128, 128, 20, 2, 0, 0, 249, 2, 17, 160, 59, 24, 236, 18, 112, 252, 49, 143, 158,
        138, 147, 134, 196, 101, 119, 214, 253, 34, 92, 91, 221, 102, 45, 194, 247, 208, 144, 43,
        3, 59, 111, 44, 160, 211, 119, 118, 220, 41, 203, 158, 96, 183, 139, 6, 112, 196, 155, 89,
        36, 96, 134, 241, 75, 217, 28, 254, 133, 244, 171, 83, 149, 165, 125, 49, 72, 160, 37, 153,
        85, 22, 169, 66, 136, 69, 157, 151, 85, 96, 157, 140, 199, 207, 47, 189, 199, 205, 187,
        238, 187, 195, 176, 192, 75, 15, 53, 235, 34, 66, 160, 79, 190, 84, 57, 232, 153, 101, 21,
        84, 145, 130, 35, 62, 225, 249, 150, 11, 212, 216, 177, 159, 253, 13, 41, 127, 231, 76,
        128, 20, 219, 183, 189, 160, 44, 191, 246, 24, 217, 161, 208, 183, 75, 226, 77, 90, 103,
        25, 13, 233, 17, 237, 63, 27, 237, 182, 21, 242, 73, 159, 146, 165, 57, 122, 3, 148, 160,
        103, 187, 200, 254, 145, 152, 162, 45, 133, 213, 167, 253, 253, 179, 99, 103, 44, 247, 234,
        147, 112, 209, 217, 254, 54, 42, 222, 251, 47, 233, 208, 174, 160, 170, 161, 150, 54, 30,
        69, 180, 114, 171, 255, 33, 91, 97, 142, 160, 63, 252, 131, 231, 250, 179, 220, 189, 114,
        229, 227, 48, 71, 77, 165, 183, 28, 160, 91, 205, 82, 139, 47, 131, 78, 99, 59, 14, 233,
        32, 238, 247, 22, 99, 35, 75, 50, 178, 155, 79, 80, 178, 16, 218, 95, 167, 40, 18, 250,
        162, 160, 138, 100, 180, 145, 3, 108, 31, 58, 2, 125, 206, 89, 244, 31, 228, 96, 142, 222,
        91, 61, 248, 9, 32, 62, 100, 253, 227, 229, 4, 92, 58, 88, 160, 121, 114, 27, 38, 102, 34,
        249, 209, 80, 93, 140, 205, 63, 59, 186, 140, 213, 212, 39, 128, 209, 142, 18, 217, 227,
        69, 204, 179, 24, 113, 136, 14, 160, 56, 123, 232, 64, 195, 140, 134, 209, 225, 102, 173,
        100, 82, 11, 100, 32, 67, 239, 154, 84, 70, 178, 60, 236, 241, 244, 136, 155, 101, 131,
        202, 138, 160, 51, 141, 135, 18, 207, 111, 48, 219, 126, 148, 195, 11, 58, 249, 168, 7,
        206, 121, 160, 207, 36, 85, 163, 140, 109, 225, 229, 227, 116, 131, 33, 125, 160, 45, 243,
        229, 37, 69, 231, 217, 25, 135, 213, 233, 156, 163, 23, 65, 143, 146, 55, 218, 95, 31, 4,
        163, 95, 9, 211, 70, 3, 27, 158, 60, 69, 160, 38, 57, 175, 27, 36, 130, 86, 72, 189, 165,
        234, 35, 43, 92, 85, 186, 212, 44, 204, 33, 177, 109, 34, 84, 255, 167, 139, 130, 217, 247,
        159, 79, 160, 80, 66, 26, 39, 236, 32, 63, 96, 156, 130, 192, 175, 145, 27, 243, 108, 212,
        12, 226, 26, 103, 88, 67, 189, 40, 216, 196, 142, 220, 180, 63, 108, 160, 72, 61, 71, 202,
        35, 170, 33, 110, 223, 71, 122, 55, 112, 48, 192, 11, 26, 140, 123, 242, 186, 28, 99, 150,
        224, 39, 144, 176, 95, 157, 26, 33, 128, 178, 1, 0, 0, 249, 1, 175, 32, 185, 1, 171, 2,
        249, 1, 167, 1, 131, 98, 207, 217, 185, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0,
        0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 2, 0, 0, 16, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0,
        0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 248, 157, 248, 155, 148, 218, 193, 127, 149, 141, 46, 229, 35, 162, 32, 98, 6, 153,
        69, 151, 193, 61, 131, 30, 199, 248, 99, 160, 221, 242, 82, 173, 27, 226, 200, 155, 105,
        194, 176, 104, 252, 55, 141, 170, 149, 43, 167, 241, 99, 196, 161, 22, 40, 245, 90, 77,
        245, 35, 179, 239, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59, 194, 135, 22, 130, 39, 206,
        174, 1, 222, 106, 248, 112, 255, 219, 2, 222, 65, 213, 205, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 40, 198, 192, 98, 152, 213, 20, 219, 8, 153, 52, 7, 19, 85, 229, 116, 59, 242, 29,
        96, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 42, 109, 155, 170, 8, 0, 0, 0, 119, 54, 174, 197, 182, 94, 183, 8, 141, 19, 238, 251,
        188, 92, 122, 100, 159, 168, 142, 195, 144, 199, 198, 150, 125, 105, 146, 224, 102, 41,
        186, 165, 199, 194, 113, 87, 0, 162, 89, 220, 47, 105, 255, 58, 34, 8, 229, 42, 105, 204,
        32, 168, 128, 171, 79, 235, 39, 2, 206, 103, 171, 236, 32, 229, 179, 221, 243, 223, 127,
        48, 73, 140, 105, 166, 39, 91, 224, 243, 37, 195, 218, 73, 109, 255, 97, 222, 12, 224, 30,
        50, 246, 112, 138, 224, 215, 83, 151, 32, 108, 122, 26, 123, 254, 118, 11, 41, 200, 207,
        133, 178, 138, 133, 178, 91, 214, 118, 6, 216, 141, 140, 174, 65, 15, 55, 61, 145, 164, 86,
        28, 123, 165, 191, 6, 126, 187, 143, 21, 80, 220, 80, 150, 21, 84, 178, 178, 226, 124, 92,
        7, 67, 22, 191, 184, 27, 210, 21, 196, 235, 188, 213, 245, 165, 253, 66, 209, 106, 32, 48,
        39, 152, 239, 110, 211, 9, 151, 155, 67, 0, 61, 35, 32, 217, 240, 232, 234, 152, 49, 169,
        39, 89, 251, 75, 219, 86, 17, 78, 0, 253, 212, 193, 248, 92, 137, 43, 243, 90, 201, 168,
        146, 137, 170, 236, 177, 235, 208, 169, 108, 222, 96, 106, 116, 139, 93, 113, 128, 167, 68,
        103, 128, 199, 110, 18, 112, 43, 208, 74, 23, 156, 97, 51, 105, 65, 84, 221, 29, 47, 107,
        47, 231, 52, 22, 76, 252, 19, 64, 192,
    ];
    let payload_slice = &[
        115, 2, 0, 0, 12, 0, 0, 0, 196, 0, 0, 0, 180, 0, 0, 0, 2, 248, 177, 1, 128, 132, 83, 114,
        78, 0, 133, 5, 150, 130, 240, 0, 131, 1, 104, 58, 148, 218, 193, 127, 149, 141, 46, 229,
        35, 162, 32, 98, 6, 153, 69, 151, 193, 61, 131, 30, 199, 128, 184, 68, 169, 5, 156, 187, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 198, 192, 98, 152, 213, 20, 219, 8, 153, 52, 7, 19,
        85, 229, 116, 59, 242, 29, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 42, 109, 155, 170, 192, 128, 160, 109, 196, 53, 161, 244, 182, 128,
        236, 192, 187, 111, 9, 254, 32, 238, 129, 65, 178, 169, 62, 5, 34, 202, 1, 51, 40, 142, 3,
        217, 211, 6, 199, 160, 97, 95, 100, 142, 13, 221, 191, 72, 212, 7, 61, 116, 56, 224, 160,
        53, 188, 115, 112, 235, 74, 208, 84, 43, 164, 83, 89, 222, 108, 11, 147, 229, 171, 1, 0, 0,
        2, 249, 1, 167, 1, 131, 98, 207, 217, 185, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0,
        0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 2, 0, 0, 16, 0, 0, 16, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0,
        0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 248, 157, 248, 155, 148, 218, 193, 127, 149, 141, 46, 229, 35, 162, 32, 98, 6,
        153, 69, 151, 193, 61, 131, 30, 199, 248, 99, 160, 221, 242, 82, 173, 27, 226, 200, 155,
        105, 194, 176, 104, 252, 55, 141, 170, 149, 43, 167, 241, 99, 196, 161, 22, 40, 245, 90,
        77, 245, 35, 179, 239, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59, 194, 135, 22, 130, 39,
        206, 174, 1, 222, 106, 248, 112, 255, 219, 2, 222, 65, 213, 205, 160, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 40, 198, 192, 98, 152, 213, 20, 219, 8, 153, 52, 7, 19, 85, 229, 116, 59,
        242, 29, 96, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 42, 109, 155, 170,
    ];

    let packed_client = packed::ClientReader::from_slice(client_slice).unwrap();
    let packed_proof = packed::TransactionProofReader::from_slice(proof_slice).unwrap();
    let packed_payload = packed::TransactionPayloadReader::from_slice(payload_slice).unwrap();

    let client = packed_client.unpack();
    let result = client.verify_packed_transaction_proof(packed_proof);
    assert!(result);

    let proof = packed_proof.unpack();
    let result = proof.verify_packed_payload(packed_payload);
    assert!(result);
}
